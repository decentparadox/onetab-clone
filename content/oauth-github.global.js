(()=>{var $e=Object.create;var N=Object.defineProperty,Le=Object.defineProperties,De=Object.getOwnPropertyDescriptor,Fe=Object.getOwnPropertyDescriptors,We=Object.getOwnPropertyNames,fe=Object.getOwnPropertySymbols,Be=Object.getPrototypeOf,pe=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var V=(e,r,n)=>r in e?N(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,Z=(e,r)=>{for(var n in r||(r={}))pe.call(r,n)&&V(e,n,r[n]);if(fe)for(var n of fe(r))qe.call(r,n)&&V(e,n,r[n]);return e},G=(e,r)=>Le(e,Fe(r)),xe=e=>N(e,"__esModule",{value:!0});var be=(e,r)=>()=>(e&&(r=e(e=0)),r);var H=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),we=(e,r)=>{xe(e);for(var n in r)N(e,n,{get:r[n],enumerable:!0})},Ue=(e,r,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of We(r))!pe.call(e,t)&&t!=="default"&&N(e,t,{get:()=>r[t],enumerable:!(n=De(r,t))||n.enumerable});return e},ze=e=>Ue(xe(N(e!=null?$e(Be(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var he=(e,r,n)=>(V(e,typeof r!="symbol"?r+"":r,n),n);var Y={};we(Y,{createNanoEvents:()=>Je});var Je,K=be(()=>{Je=()=>({events:{},emit(e,...r){(this.events[e]||[]).forEach(n=>n(...r))},on(e,r){return(this.events[e]=this.events[e]||[]).push(r),()=>this.events[e]=(this.events[e]||[]).filter(n=>n!==r)}})});var X=H((Q,ye)=>{(function(e,r){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],r);else if(typeof Q!="undefined")r(ye);else{var n={exports:{}};r(n),e.browser=n.exports}})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:Q,function(e){"use strict";if(typeof globalThis!="object"||typeof chrome!="object"||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser=="undefined"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let r="The message port closed before a response was received.",n="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",t=a=>{let c={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(c).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class i extends WeakMap{constructor(o,m=void 0){super(m);this.createItem=o}get(o){return this.has(o)||this.set(o,this.createItem(o)),super.get(o)}}let g=s=>s&&typeof s=="object"&&typeof s.then=="function",A=(s,o)=>(...m)=>{a.runtime.lastError?s.reject(new Error(a.runtime.lastError.message)):o.singleCallbackArg||m.length<=1&&o.singleCallbackArg!==!1?s.resolve(m[0]):s.resolve(m)},b=s=>s==1?"argument":"arguments",$=(s,o)=>function(d,...p){if(p.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${b(o.minArgs)} for ${s}(), got ${p.length}`);if(p.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${b(o.maxArgs)} for ${s}(), got ${p.length}`);return new Promise((w,h)=>{if(o.fallbackToNoCallback)try{d[s](...p,A({resolve:w,reject:h},o))}catch(l){console.warn(`${s} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,l),d[s](...p),o.fallbackToNoCallback=!1,o.noCallback=!0,w()}else o.noCallback?(d[s](...p),w()):d[s](...p,A({resolve:w,reject:h},o))})},S=(s,o,m)=>new Proxy(o,{apply(d,p,w){return m.call(p,s,...w)}}),E=Function.call.bind(Object.prototype.hasOwnProperty),L=(s,o={},m={})=>{let d=Object.create(null),p={has(h,l){return l in s||l in d},get(h,l,y){if(l in d)return d[l];if(!(l in s))return;let f=s[l];if(typeof f=="function")if(typeof o[l]=="function")f=S(s,s[l],o[l]);else if(E(m,l)){let M=$(l,m[l]);f=S(s,s[l],M)}else f=f.bind(s);else if(typeof f=="object"&&f!==null&&(E(o,l)||E(m,l)))f=L(f,o[l],m[l]);else if(E(m,"*"))f=L(f,o[l],m["*"]);else return Object.defineProperty(d,l,{configurable:!0,enumerable:!0,get(){return s[l]},set(M){s[l]=M}}),f;return d[l]=f,f},set(h,l,y,f){return l in d?d[l]=y:s[l]=y,!0},defineProperty(h,l,y){return Reflect.defineProperty(d,l,y)},deleteProperty(h,l){return Reflect.deleteProperty(d,l)}},w=Object.create(s);return new Proxy(w,p)},U=s=>({addListener(o,m,...d){o.addListener(s.get(m),...d)},hasListener(o,m){return o.hasListener(s.get(m))},removeListener(o,m){o.removeListener(s.get(m))}}),Oe=new i(s=>typeof s!="function"?s:function(m){let d=L(m,{},{getContent:{minArgs:0,maxArgs:0}});s(d)}),de=!1,ue=new i(s=>typeof s!="function"?s:function(m,d,p){let w=!1,h,l=new Promise(T=>{h=function(_){de||(console.warn(n,new Error().stack),de=!0),w=!0,T(_)}}),y;try{y=s(m,d,h)}catch(T){y=Promise.reject(T)}let f=y!==!0&&g(y);if(y!==!0&&!f&&!w)return!1;let M=T=>{T.then(_=>{p(_)},_=>{let J;_&&(_ instanceof Error||typeof _.message=="string")?J=_.message:J="An unexpected error occurred",p({__mozWebExtensionPolyfillReject__:!0,message:J})}).catch(_=>{console.error("Failed to send onMessage rejected reply",_)})};return M(f?y:l),!0}),je=({reject:s,resolve:o},m)=>{a.runtime.lastError?a.runtime.lastError.message===r?o():s(new Error(a.runtime.lastError.message)):m&&m.__mozWebExtensionPolyfillReject__?s(new Error(m.message)):o(m)},Ae=(s,o,m,...d)=>{if(d.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${b(o.minArgs)} for ${s}(), got ${d.length}`);if(d.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${b(o.maxArgs)} for ${s}(), got ${d.length}`);return new Promise((p,w)=>{let h=je.bind(null,{resolve:p,reject:w});d.push(h),m.sendMessage(...d)})},Re={devtools:{network:{onRequestFinished:U(Oe)}},runtime:{onMessage:U(ue),onMessageExternal:U(ue),sendMessage:Ae.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:Ae.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},z={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return c.privacy={network:{"*":z},services:{"*":z},websites:{"*":z}},L(a,Re,c)};e.exports=t(chrome)}else e.exports=globalThis.browser})});var _e={};we(_e,{NonError:()=>P,deserializeError:()=>He,serializeError:()=>Ge});function Ge(e,r={}){let{maxDepth:n=Number.POSITIVE_INFINITY}=r;return typeof e=="object"&&e!==null?re({from:e,seen:[],forceEnumerable:!0,maxDepth:n,depth:0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function He(e,r={}){let{maxDepth:n=Number.POSITIVE_INFINITY}=r;if(e instanceof Error)return e;if(typeof e=="object"&&e!==null&&!Array.isArray(e)){let t=new Error;return re({from:e,seen:[],to_:t,maxDepth:n,depth:0}),t}return new P(e)}var P,Ve,ee,Ze,re,ve=be(()=>{P=class extends Error{constructor(r){super(P._prepareSuperMessage(r));he(this,"name","NonError")}static _prepareSuperMessage(r){try{return JSON.stringify(r)}catch{return String(r)}}},Ve=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],ee=Symbol(".toJSON was called"),Ze=e=>{e[ee]=!0;let r=e.toJSON();return delete e[ee],r},re=({from:e,seen:r,to_:n,forceEnumerable:t,maxDepth:a,depth:c})=>{let i=n||(Array.isArray(e)?[]:{});if(r.push(e),c>=a)return i;if(typeof e.toJSON=="function"&&e[ee]!==!0)return Ze(e);for(let[g,A]of Object.entries(e)){if(typeof Buffer=="function"&&Buffer.isBuffer(A)){i[g]="[object Buffer]";continue}if(A!==null&&typeof A=="object"&&typeof A.pipe=="function"){i[g]="[object Stream]";continue}if(typeof A!="function"){if(!A||typeof A!="object"){i[g]=A;continue}if(!r.includes(e[g])){c++,i[g]=re({from:e[g],seen:[...r],forceEnumerable:t,maxDepth:a,depth:c});continue}i[g]="[Circular]"}}for(let{property:g,enumerable:A}of Ve)typeof e[g]=="string"&&Object.defineProperty(i,g,{value:e[g],enumerable:t?!0:A,configurable:!0,writable:!0});return i}});var D=H((kr,ne)=>{var Ye=e=>typeof crypto!="undefined"&&typeof crypto.getRandomValues=="function"?()=>{let r=crypto.getRandomValues(new Uint8Array(1))[0];return(r>=e?r%e:r).toString(e)}:()=>Math.floor(Math.random()*e).toString(e),ke=(e=7,r=!1)=>Array.from({length:e},Ye(r?16:36)).join("");ne.exports=ke;ne.exports.default=ke});var Ne=H((Er,Te)=>{var Ke=Object.create,F=Object.defineProperty,Qe=Object.getOwnPropertyDescriptor,Xe=Object.getOwnPropertyNames,er=Object.getPrototypeOf,rr=Object.prototype.hasOwnProperty,nr=(e,r)=>{for(var n in r)F(e,n,{get:r[n],enumerable:!0})},Ee=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of Xe(r))!rr.call(e,a)&&a!==n&&F(e,a,{get:()=>r[a],enumerable:!(t=Qe(r,a))||t.enumerable});return e},O=(e,r,n)=>(n=e!=null?Ke(er(e)):{},Ee(r||!e||!e.__esModule?F(n,"default",{value:e,enumerable:!0}):n,e)),tr=e=>Ee(F({},"__esModule",{value:!0}),e),Me={};nr(Me,{Stream:()=>R,allowWindowMessaging:()=>cr,getCurrentContext:()=>pr,isInternalEndpoint:()=>gr,onMessage:()=>le,onOpenStreamChannel:()=>yr,openStream:()=>hr,parseEndpoint:()=>B,sendMessage:()=>q,setNamespace:()=>mr});Te.exports=tr(Me);var sr=(K(),Y),I=O(X()),or=(ve(),_e),ir=O(D()),W=O(X()),ar=/^((?:background$)|devtools|popup|options|content-script|window)(?:@(\d+)(?:\.(\d+))?)?$/,B=e=>{let[,r,n,t]=e.match(ar)||[];return{context:r,tabId:+n,frameId:t?+t:void 0}},gr=({context:e})=>["content-script","background","devtools"].includes(e),te=e=>W.default[e],lr=()=>{var e,r,n;let t=W.default.runtime.getManifest();if(typeof window=="undefined")return"background";let a=((e=t.browser_action)==null?void 0:e.default_popup)||((r=t.action)==null?void 0:r.default_popup);return a&&new URL(W.default.runtime.getURL(a)).pathname===window.location.pathname?"popup":((n=t.options_ui)==null?void 0:n.page)&&new URL(W.default.runtime.getURL(t.options_ui.page)).pathname===window.location.pathname?"options":"background"},u=te("devtools")?"devtools":te("tabs")?lr():te("extension")?"content-script":typeof document!="undefined"?"window":null,Ie=(0,ir.default)(),se=new Map,Ce=new Map,oe=new Set,ie=new Map,x=null,v,ae;j();function mr(e){v=e}function cr(e){ae=!0,v=e}function j(){if(u===null)throw new Error("Unable to detect runtime context i.e webext-bridge can't figure out what to do");if((u==="window"||u==="content-script")&&window.addEventListener("message",Ar),u==="content-script"&&top===window&&(x=I.default.runtime.connect(),x.onMessage.addListener(e=>{k(e)}),x.onDisconnect.addListener(()=>{x=null,j()})),u==="content-script"&&top!==window&&(x=I.default.runtime.connect(),x.onMessage.addListener(e=>{k(e)}),x.onDisconnect.addListener(()=>{x=null,j()})),u==="devtools"){let{tabId:e}=I.default.devtools.inspectedWindow,r=`devtools@${e}`;x=I.default.runtime.connect(void 0,{name:r}),x.onMessage.addListener(n=>{k(n)}),x.onDisconnect.addListener(()=>{x=null,j()})}if(u==="popup"||u==="options"){let e=`${u}`;x=I.default.runtime.connect(void 0,{name:e}),x.onMessage.addListener(r=>{k(r)}),x.onDisconnect.addListener(()=>{x=null,j()})}u==="background"&&I.default.runtime.onConnect.addListener(e=>{let r=e.name||`content-script@${e.sender.tab.id}`,n=e.sender.frameId;n&&(r=`${r}.${n}`);let{context:t,tabId:a,frameId:c}=B(r);!a&&t!=="popup"&&t!=="options"||(ie.set(r,e),oe.forEach(i=>{i.resolvedDestination===r&&(e.postMessage(i.message),oe.delete(i))}),e.onDisconnect.addListener(()=>{ie.delete(r)}),e.onMessage.addListener(i=>{var g;((g=i==null?void 0:i.origin)==null?void 0:g.context)&&(i.origin.tabId=a,i.origin.frameId=c,k(i))}))})}function k(e){let{origin:r,destination:n}=e;if(!e.hops.includes(Ie)&&(e.hops.push(Ie),!(u==="content-script"&&[n,r].some(t=>(t==null?void 0:t.context)==="window")&&!ae))){if(!n)return dr(e);if(n.context){if(u==="window")return ge(window,e);if(u==="content-script"&&n.context==="window")return e.destination=null,ge(window,e);if(["devtools","content-script","popup","options"].includes(u))return n.context==="background"&&(e.destination=null),x.postMessage(e);if(u==="background"){let{context:t,tabId:a,frameId:c}=n,{tabId:i}=r;t!=="window"?e.destination=null:e.destination.tabId=null;let g=["popup","options"].includes(t)?t:`${t==="window"?"content-script":t}@${a||i}`;c&&(g=`${g}.${c}`);let A=ie.get(g);A?A.postMessage(e):oe.add({resolvedDestination:g,message:e})}}}}async function dr(e){let{transactionId:r,messageID:n,messageType:t}=e,a=()=>{let i=se.get(r);if(i){let{err:g,data:A}=e;if(g){let b=g,$=self[b.name],S=new(typeof $=="function"?$:Error)(b.message);for(let E in b)S[E]=b[E];i.reject(S)}else i.resolve(A);se.delete(r)}},c=async()=>{let i,g,A=!1;try{let b=Ce.get(n);if(typeof b=="function")i=await b({sender:e.origin,id:n,data:e.data,timestamp:e.timestamp});else throw A=!0,new Error(`[webext-bridge] No handler registered in '${u}' to accept messages with id '${n}'`)}catch(b){g=b}finally{if(g&&(e.err=(0,or.serializeError)(g)),k(G(Z({},e),{messageType:"reply",data:i,origin:{context:u,tabId:null},destination:e.origin,hops:[]})),g&&!A)throw i}};switch(t){case"reply":return a();case"message":return c()}}function ur(e){}async function Ar({data:e,ports:r}){if(!(u==="content-script"&&!ae)){if(e.cmd==="__crx_bridge_verify_listening"&&e.scope===v&&e.context!==u)r[0].postMessage(!0);else if(e.cmd==="__crx_bridge_route_message"&&e.scope===v&&e.context!==u){let{payload:n}=e;ur(n),u==="content-script"&&(n.origin={context:"window",tabId:null}),k(n)}}}function ge(e,r){fr();let n=new MessageChannel,t=setTimeout(()=>{n.port1.onmessage=null,ge(e,r)},300);n.port1.onmessage=()=>{clearTimeout(t),e.postMessage({cmd:"__crx_bridge_route_message",scope:v,context:u,payload:r},"*")},e.postMessage({cmd:"__crx_bridge_verify_listening",scope:v,context:u},"*",[n.port2])}function fr(){if(typeof v!="string"||v.length===0)throw new Error(`webext-bridge uses window.postMessage to talk with other "window"(s), for message routing and stuff,which is global/conflicting operation in case there are other scripts using webext-bridge. Call Bridge#setNamespace(nsps) to isolate your app. Example: setNamespace('com.facebook.react-devtools'). Make sure to use same namespace across all your scripts whereever window.postMessage is likely to be used\``)}function pr(){return u}function le(e,r){Ce.set(e,r)}var xr=O(D());async function q(e,r,n="background"){let t=typeof n=="string"?B(n):n,a="Bridge#sendMessage ->";if(!t.context)throw new TypeError(`${a} Destination must be any one of known destinations`);if(u==="background"){let{context:c,tabId:i}=t;if(c!=="background"&&!i)throw new TypeError(`${a} When sending messages from background page, use @tabId syntax to target specific tab`)}return new Promise((c,i)=>{let g={messageID:e,data:r,destination:t,messageType:"message",transactionId:(0,xr.default)(),origin:{context:u,tabId:null},hops:[],timestamp:Date.now()};se.set(g.transactionId,{resolve:c,reject:i}),k(g)})}var C=class{constructor(e){this.handleStreamClose=()=>{this.isClosed||(this.isClosed=!0,this.emitter.emit("closed",!0),this.emitter.events={})},this.internalInfo=e,this.emitter=(0,sr.createNanoEvents)(),this.isClosed=!1,C.initDone||(le("__crx_bridge_stream_transfer__",r=>{let{streamId:n,streamTransfer:t,action:a}=r.data,c=C.openStreams.get(n);c&&!c.isClosed&&(a==="transfer"&&c.emitter.emit("message",t),a==="close"&&(C.openStreams.delete(n),c.handleStreamClose()))}),C.initDone=!0),C.openStreams.set(e.streamId,this)}get info(){return this.internalInfo}send(e){if(this.isClosed)throw new Error("Attempting to send a message over closed stream. Use stream.onClose(<callback>) to keep an eye on stream status");q("__crx_bridge_stream_transfer__",{streamId:this.internalInfo.streamId,streamTransfer:e,action:"transfer"},this.internalInfo.endpoint)}close(e){e&&this.send(e),this.handleStreamClose(),q("__crx_bridge_stream_transfer__",{streamId:this.internalInfo.streamId,streamTransfer:null,action:"close"},this.internalInfo.endpoint)}onMessage(e){return this.getDisposable("message",e)}onClose(e){return this.getDisposable("closed",e)}getDisposable(e,r){let n=this.emitter.on(e,r);return Object.assign(n,{dispose:n,close:n})}},R=C;R.initDone=!1;R.openStreams=new Map;var br=O(D()),wr=(K(),Y),me=new Map,ce=new Map,Se=(0,wr.createNanoEvents)();le("__crx_bridge_stream_open__",e=>new Promise(r=>{let{sender:n,data:t}=e,{channel:a}=t,c=!1,i=()=>{},g=()=>{let A=ce.get(a);typeof A=="function"?(A(new R(G(Z({},t),{endpoint:n}))),c&&i(),r(!0)):c||(c=!0,i=Se.on("did-change-stream-callbacks",g))};g()}));async function hr(e,r){if(me.has(e))throw new Error("webext-bridge: A Stream is already open at this channel");let n=typeof r=="string"?B(r):r,t={streamId:(0,br.default)(),channel:e,endpoint:n},a=new R(t);return a.onClose(()=>me.delete(e)),await q("__crx_bridge_stream_open__",t,n),me.set(e,a),a}function yr(e,r){if(ce.has(e))throw new Error("webext-bridge: This channel has already been claimed. Stream allows only one-on-one communication");ce.set(e,r),Se.emit("did-change-stream-callbacks")}});var Pe=ze(Ne()),_r=window.location.href.substring(window.location.href.indexOf("?")).split("=")[1];(0,Pe.sendMessage)("oauth-code",{code:_r},"background");window.close();})();
